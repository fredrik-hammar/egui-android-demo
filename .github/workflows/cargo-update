name: Cargo Update
on:
  schedule:
    - cron: '30 5 * * MON'
env:
  CARGO_TERM_COLOR: never // Can't have color codes in commit message.
jobs:
  build:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v3
    - name: Cargo Update
      run: 2>&1 cargo update|tee $GITHUB_OUTPUT
      id: cargo_update
    - name: Create Pull Request
      uses: peter-evans/create-pull-request@v6
      with:
        commit-message: |
          cargo-update

          ${{join(steps.cargo_update.outputs.*, '\n')}}
        branch: cargo-update
        delete-branch: true
        labels: |
          automated pr
        assignees: fredrik-hammar
        reviewers: fredrik-hammar
